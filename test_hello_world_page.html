<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuikly Desktop - HelloWorldPage æ¸²æŸ“æµ‹è¯•</title>
    <style>
        body, html {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f0f2f5;
            color: #333;
        }
        
        #kuikly-render-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 20px;
            background: linear-gradient(135deg, #e0f7fa 0%, #e8eaf6 100%);
        }
        
        .status-message {
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            background-color: white;
        }
        
        .status-message .success { color: #4CAF50; }
        .status-message .error { color: #F44336; }
        .status-message .pending { color: #FFC107; }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- çŠ¶æ€æ˜¾ç¤º -->
    <div id="status-display" class="status-message">
        <span class="pending">â³</span> é¡µé¢åŠ è½½ä¸­...
    </div>
    
    <!-- æ¸²æŸ“å®¹å™¨ -->
    <div id="kuikly-render-container"></div>
    
    <!-- åŠ è½½ h5app æ¸²æŸ“å¼•æ“ï¼ˆåŒ…å«å®Œæ•´çš„ core-render-webï¼‰ -->
    <script src="h5app/build/kotlin-webpack/js/productionExecutable/h5App.js"></script>
    
    <!-- åŠ è½½æ¡Œé¢ç«¯æ¸²æŸ“å¼•æ“ -->
    <script src="render.js"></script>
    
    <script>
        console.log('[Kuikly Desktop] ğŸ§ª HelloWorldPage æ¸²æŸ“æµ‹è¯•é¡µé¢å·²åŠ è½½');
        
        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus(message, type) {
            const statusElement = document.getElementById('status-display');
            if (statusElement) {
                statusElement.innerHTML = `<span class="${type}">${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â³'}</span> ${message}`;
            }
        }
        
        // æ£€æŸ¥æ¸²æŸ“å¼•æ“æ˜¯å¦åŠ è½½æˆåŠŸ
        function checkRenderEngine() {
            if (typeof window.renderContent === 'function') {
                console.log('[Kuikly Desktop] âœ… æ¸²æŸ“å¼•æ“å¯ç”¨');
                updateStatus('âœ… æ¸²æŸ“å¼•æ“åŠ è½½æˆåŠŸ', 'success');
                return true;
            } else {
                console.log('[Kuikly Desktop] â³ ç­‰å¾…æ¸²æŸ“å¼•æ“åŠ è½½...');
                updateStatus('â³ ç­‰å¾…æ¸²æŸ“å¼•æ“åŠ è½½...', 'pending');
                return false;
            }
        }
        
        // æ£€æŸ¥ Kuikly æ¸²æŸ“å¼•æ“æ˜¯å¦å¯ç”¨
        function checkKuiklyEngine() {
            if (typeof window.com !== 'undefined' && 
                window.com.tencent && 
                window.com.tencent.kuikly && 
                window.com.tencent.kuikly.core && 
                window.com.tencent.kuikly.core.render && 
                window.com.tencent.kuikly.core.render.web) {
                console.log('[Kuikly Desktop] âœ… Kuikly æ¸²æŸ“å¼•æ“å¯ç”¨');
                return true;
            } else {
                console.log('[Kuikly Desktop] âš ï¸ Kuikly æ¸²æŸ“å¼•æ“ä¸å¯ç”¨ï¼Œå°†ä½¿ç”¨æ¨¡æ‹Ÿæ¸²æŸ“');
                return false;
            }
        }
        
        console.log('[Kuikly Desktop] âœ… renderContent å‡½æ•°å®šä¹‰å®Œæˆ');
        
        // æ£€æŸ¥æ¸²æŸ“å¼•æ“åŠ è½½çŠ¶æ€
        setTimeout(() => {
            if (checkRenderEngine()) {
                updateStatus('âœ… æ¸²æŸ“å¼•æ“åŠ è½½æˆåŠŸï¼Œå‡†å¤‡å°±ç»ª', 'success');
                
                // æ£€æŸ¥ Kuikly æ¸²æŸ“å¼•æ“
                if (checkKuiklyEngine()) {
                    updateStatus('âœ… Kuikly æ¸²æŸ“å¼•æ“å¯ç”¨ï¼Œæ”¯æŒçœŸå®ç»„ä»¶æ¸²æŸ“', 'success');
                } else {
                    updateStatus('âš ï¸ Kuikly æ¸²æŸ“å¼•æ“ä¸å¯ç”¨ï¼Œå°†ä½¿ç”¨æ¨¡æ‹Ÿæ¸²æŸ“', 'pending');
                }
            } else {
                updateStatus('â³ ç­‰å¾…æ¸²æŸ“å¼•æ“åŠ è½½...', 'loading');
                // ç»§ç»­æ£€æŸ¥
                setTimeout(() => {
                    if (checkRenderEngine()) {
                        updateStatus('âœ… æ¸²æŸ“å¼•æ“åŠ è½½æˆåŠŸï¼Œå‡†å¤‡å°±ç»ª', 'success');
                    } else {
                        updateStatus('âŒ æ¸²æŸ“å¼•æ“åŠ è½½å¤±è´¥', 'error');
                    }
                }, 2000);
            }
        }, 1000);
        
        // é€šçŸ¥ JVM ç«¯é¡µé¢å·²å°±ç»ª
        setTimeout(() => {
            if (window.cefQuery) {
                window.cefQuery({
                    request: JSON.stringify({ type: 'renderReady' }),
                    onSuccess: function(response) {
                        console.log('[Kuikly Desktop] âœ… å·²é€šçŸ¥ JVM ç«¯é¡µé¢å°±ç»ª');
                    },
                    onFailure: function(error_code, error_message) {
                        console.error('[Kuikly Desktop] âŒ é€šçŸ¥ JVM å¤±è´¥:', error_message);
                    }
                });
            } else {
                console.log('[Kuikly Desktop] âš ï¸ JS Bridge æœªå°±ç»ª');
            }
        }, 2000);
    </script>
</body>
</html>
